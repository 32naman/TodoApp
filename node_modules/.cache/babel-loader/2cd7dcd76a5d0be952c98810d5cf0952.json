{"ast":null,"code":"import _toConsumableArray from\"/home/revpro/Desktop/new/deploy/ToDoAppReact/ToDoApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/revpro/Desktop/new/deploy/ToDoAppReact/ToDoApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import netCalls from\"../netCallsShare\";import SearchBar from\"./SearchBar\";import TodoList from\"./TodoListShare\";import InputTodo from\"./InputTodoShare\";import\"./TodoApp.css\";// const PORT = 8000;\nvar getURL=\"https://todonaman1.herokuapp.com/getdata\";var shareSocketURL=\"wss://todonaman1.herokuapp.com/shareSocket\";function SharedTodo(props){var url=new URL(document.URL);var search_params=url.searchParams;var hash_val=search_params.get(\"hash\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),todos=_useState2[0],setTodos=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),filteredTodos=_useState6[0],setFilteredTodos=_useState6[1];var _useState7=useState(new Date().toLocaleDateString(\"en-IN\",{day:\"numeric\",month:\"short\",weekday:\"short\"})),_useState8=_slicedToArray(_useState7,1),date=_useState8[0];var _useState9=useState(hash_val),_useState10=_slicedToArray(_useState9,1),hash=_useState10[0];var _useState11=useState(new WebSocket(shareSocketURL)),_useState12=_slicedToArray(_useState11,2),setSocket=_useState12[1];var state={todos:todos,searchQuery:searchQuery,filteredTodos:filteredTodos,date:date,hash:hash,listNum:1,totalLists:1,id_token:null,sharing:\"off\"};// let updateState = (stateData:State) => {\n//     if(stateData.todos) setTodos([...stateData.todos]);\n//     if(stateData.searchQuery) setSearchQuery(stateData.searchQuery);\n//     if(stateData.filteredTodos !== undefined){\n//         if(stateData.filteredTodos === null) setFilteredTodos(null);\n//         else setFilteredTodos([...stateData.filteredTodos]);\n//     }\n//     if(stateData.date) setDate(stateData.date);\n//     if(stateData.hash) setHash(stateData.hash);\n// }\nuseEffect(function(){console.log(\"here Mount\");// this.onLoad();\nvar startSocket=new WebSocket(shareSocketURL);setSocket(startSocket);console.log(\"initial load\");var todos=[];netCalls.getJSON(getURL,function(err,data){if(err!==null){console.log(\"Empty\");setTodos([].concat(todos));}else{console.log(\"Loaded\");console.log(data);var dataWithKey=data;if(dataWithKey[\"json\"]!==undefined)setTodos(JSON.parse(dataWithKey[\"json\"]));}},hash,startSocket);startSocket.onmessage=function(event){console.log(event.data);var data=JSON.parse(event.data);setTodos(_toConsumableArray(data));};},[hash]);return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"date\"},date),/*#__PURE__*/React.createElement(SearchBar,{state:state,setFilteredTodos:setFilteredTodos,setSearchQuery:setSearchQuery})),/*#__PURE__*/React.createElement(TodoList,{state:state,setTodos:setTodos}),/*#__PURE__*/React.createElement(InputTodo,{state:state,setTodos:setTodos}));}export default SharedTodo;","map":{"version":3,"sources":["/home/revpro/Desktop/new/deploy/ToDoAppReact/ToDoApp/src/components/SharedTodo.tsx"],"names":["React","useState","useEffect","netCalls","SearchBar","TodoList","InputTodo","getURL","shareSocketURL","SharedTodo","props","url","URL","document","search_params","searchParams","hash_val","get","todos","setTodos","searchQuery","setSearchQuery","filteredTodos","setFilteredTodos","Date","toLocaleDateString","day","month","weekday","date","hash","WebSocket","setSocket","state","listNum","totalLists","id_token","sharing","console","log","startSocket","getJSON","err","data","dataWithKey","undefined","JSON","parse","onmessage","event"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport netCalls from \"../netCallsShare\";\nimport SearchBar from \"./SearchBar\";\nimport TodoList from \"./TodoListShare\";\nimport InputTodo from \"./InputTodoShare\";\nimport \"./TodoApp.css\";\nimport { State, TodoItem } from \"./interfaces\";\n// const PORT = 8000;\nconst getURL = `https://todonaman1.herokuapp.com/getdata`;\nconst shareSocketURL = `wss://todonaman1.herokuapp.com/shareSocket`;\ninterface Data {\n  [Key: string]: string | undefined;\n}\n\nfunction SharedTodo(props: {\n  state: {\n    id_token: string;\n  };\n}) {\n  const url = new URL(document.URL);\n  const search_params = url.searchParams;\n  const hash_val = search_params.get(\"hash\");\n  const [todos, setTodos] = useState<TodoItem[]>([]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  let [filteredTodos, setFilteredTodos] = useState<TodoItem[] | null>(null);\n  const [date] = useState(\n    new Date().toLocaleDateString(\"en-IN\", {\n      day: \"numeric\",\n      month: \"short\",\n      weekday: \"short\",\n    })\n  );\n  const [hash] = useState(hash_val);\n  const [, setSocket] = useState<WebSocket>(new WebSocket(shareSocketURL));\n  const state: State = {\n    todos: todos,\n    searchQuery: searchQuery,\n    filteredTodos: filteredTodos,\n    date: date,\n    hash: hash,\n    listNum: 1,\n    totalLists: 1,\n    id_token: null,\n    sharing: \"off\",\n  };\n\n  // let updateState = (stateData:State) => {\n  //     if(stateData.todos) setTodos([...stateData.todos]);\n  //     if(stateData.searchQuery) setSearchQuery(stateData.searchQuery);\n  //     if(stateData.filteredTodos !== undefined){\n  //         if(stateData.filteredTodos === null) setFilteredTodos(null);\n  //         else setFilteredTodos([...stateData.filteredTodos]);\n  //     }\n  //     if(stateData.date) setDate(stateData.date);\n  //     if(stateData.hash) setHash(stateData.hash);\n  // }\n\n  useEffect(() => {\n    console.log(\"here Mount\");\n    // this.onLoad();\n    let startSocket = new WebSocket(shareSocketURL);\n    setSocket(startSocket);\n\n    console.log(\"initial load\");\n    let todos: TodoItem[] = [];\n    netCalls.getJSON(\n      getURL,\n      (err: number | null, data: object) => {\n        if (err !== null) {\n          console.log(\"Empty\");\n          setTodos([...todos]);\n        } else {\n          console.log(\"Loaded\");\n          console.log(data);\n          let dataWithKey = data as Data;\n          if (dataWithKey[\"json\"] !== undefined)\n            setTodos(JSON.parse(dataWithKey[\"json\"]));\n        }\n      },\n      hash,\n      startSocket\n    );\n\n    startSocket.onmessage = (event) => {\n      console.log(event.data);\n      let data = JSON.parse(event.data);\n      setTodos([...data]);\n    };\n  }, [hash]);\n\n  return (\n    <div className=\"container\">\n      <div className=\"header\">\n        <div className=\"date\">{date}</div>\n        <SearchBar\n          state={state}\n          setFilteredTodos={setFilteredTodos}\n          setSearchQuery={setSearchQuery}\n        />\n      </div>\n      <TodoList state={state} setTodos={setTodos} />\n      <InputTodo state={state} setTodos={setTodos} />\n    </div>\n  );\n}\n\nexport default SharedTodo;\n"]},"metadata":{},"sourceType":"module"}